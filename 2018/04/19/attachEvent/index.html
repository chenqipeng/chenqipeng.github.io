<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Stuff</title></head><body><header><nav><ul><li><a href="/">Stuff</a></li><li><ul><li><a href="/categories/stuff">stuff</a></li></ul></li><li><ul><li><a href="/tags/Javascript">Javascript</a></li><li><a href="/tags/DOM">DOM</a></li><li><a href="/tags/Event">Event</a></li><li><a href="/tags/Markdown">Markdown</a></li><li><a href="/tags/CSS">CSS</a></li><li><a href="/tags/计算机原理">计算机原理</a></li></ul></li></ul></nav></header><main><article><h2>attachEvent</h2><div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 兼容FF和IE和Opera</span></span><br><span class="line"><span class="keyword">var</span> theEvent = e || <span class="built_in">window</span>.event;</span><br></pre></td></tr></table></figure>
<p>以上代码是在同事写的<code>addEventListener</code>里发现的，根据注释，我想大概是IE的兼容性处理代码，但具体详情不明所以。一番查询，得出一些事件的知识点：</p>
<ul>
<li><p>早期IE浏览器（IE8及早期版本）是不支持<a href="https://caniuse.com/#search=addEventListener" target="_blank" rel="noopener">addEventListener</a>语法的，这些IE的早期版本使用的是微软一个专有的替代性标准<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/attachEvent" target="_blank" rel="noopener">attachEvent</a></p>
</li>
<li><p>根据<a href="https://stackoverflow.com/questions/3493033/what-is-the-meaning-of-this-var-evt-eventwindow-event" target="_blank" rel="noopener">网友回答</a>：在IE中（所有版本？），event对象是一个全局变量，由于历史原因，所有全局变量都是window对象的成员变量。所以有以上代码写法。</p>
</li>
<li><p>根据<a href="http://www.cnblogs.com/huajs/archive/2011/11/10/2244793.html" target="_blank" rel="noopener">网友博客</a>和我自己的实测，其实这一写法是多余的。原因在于，无论是<code>addEventListener</code>还是<code>attachEvent</code>函数，其listener参数接收到的传入参数，都是event对象。即使是<code>attachEvent</code>，其listener的传入参数也是event对象，这个对象是window.event的一个<strong>复制的对象</strong>(两个并不全等)。所以无需以上写法来判断event对象是否存在。</p>
</li>
</ul>
</div></article></main><footer> </footer></body></html>